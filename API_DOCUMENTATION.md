# API Документация: Данные по акциям

## Обзор

Этот API предоставляет доступ к последним доступным биржевым данным и аналитическим показателям для различных компаний.

## Конечная точка (Endpoint)

`GET /stock/{ticker}`

### Параметры пути

-   `ticker` (string, required): Тикер компании. Например, `SBER`, `GAZP`.

### Успешный ответ (Код 200)

Возвращает JSON-объект с последними данными по указанному тикеру.

**Пример ответа для `/stock/SBER`:**

```json
{
    "date": "2023-10-26",
    "SECID": "SBER",
    "OPEN": 270.50,
    "HIGH": 272.30,
    "LOW": 269.80,
    "CLOSE": 271.90,
    "VOLUME": 15000000,
    "RSI": 65.3,
    "MACD": 1.25,
    "MACD_Signal": 1.10,
    "BB_Upper": 275.50,
    "BB_Lower": 265.00,
    "NetProfit_y": 1200000000000,
    "Revenue_y": 5000000000000,
    "PE_y": 5.8,
    "PB_y": 0.9,
    "WeightedIndices_blog_score_roll_avg_30": 0.65,
    "WeightedIndices_news_score_roll_avg_30": 0.72
}
```

### Описание полей ответа

| Поле                                     | Тип     | Описание                                                                 |
| :--------------------------------------- | :------ | :----------------------------------------------------------------------- |
| `date`                                   | string  | Дата, к которой относятся данные (YYYY-MM-DD)                           |
| `SECID`                                  | string  | Тикер компании                                                          |
| `OPEN`                                   | float   | Цена открытия                                                            |
| `HIGH`                                   | float   | Максимальная цена за день                                                |
| `LOW`                                    | float   | Минимальная цена за день                                                 |
| `CLOSE`                                  | float   | Цена закрытия                                                            |
| `VOLUME`                                 | integer | Объем торгов (количество акций)                                          |
| `RSI`                                    | float   | Индекс относительной силы (Relative Strength Index)                      |
| `MACD`                                   | float   | Значение индикатора MACD (Moving Average Convergence Divergence)         |
| `MACD_Signal`                            | float   | Сигнальная линия MACD                                                    |
| `BB_Upper`                               | float   | Верхняя граница полос Боллинджера (Bollinger Bands)                      |
| `BB_Lower`                               | float   | Нижняя граница полос Боллинджера                                          |
| `NetProfit_y`                            | float   | Чистая прибыль компании за последний отчетный год                        |
| `Revenue_y`                              | float   | Выручка компании за последний отчетный год                               |
| `PE_y`                                   | float   | Соотношение рыночной цены акции к годовой прибыли на акцию (Price-to-Earnings) |
| `PB_y`                                   | float   | Соотношение рыночной цены акции к ее балансовой стоимости (Price-to-Book) |
| `WeightedIndices_blog_score_roll_avg_30` | float   | Средневзвешенный балл анализа настроений по блогам за последние 30 дней  |
| `WeightedIndices_news_score_roll_avg_30` | float   | Средневзвешенный балл анализа настроений по новостям за последние 30 дней |

### Ответы об ошибках

-   **Код 404 (Not Found):**
    ```json
    {
        "error": "Ticker not found"
    }
    ```
    Возникает, если для указанного тикера нет CSV-файла.

-   **Код 200 (OK) с ошибкой в теле:**
    ```json
    {
        "error": "No data available for this ticker"
    }
    ```
    Возникает, если CSV-файл найден, но он пуст.

    ```json
    {
        "error": "[Конкретная ошибка чтения файла или обработки данных]"
    }
    ```
    Возникает в случае других проблем при обработке запроса.

## Примечания

-   Данные обновляются по мере обновления CSV-файлов на сервере.
-   Список доступных тикеров можно найти в файле `configs/all_companies_config.json`. 